<ion-row class="classification-main">
    <ion-row class="header-padding border-top">
        <ion-col class="display-start" size="3">
            <ion-label class="action-label mar-b-label">Job Type:</ion-label>
            <mat-select placeholder="Select" disableOptionCentering class="form-control drop-mat mat_width_css"
                [(ngModel)]="jobType" (ngModelChange)="getDataSetDropDownData()">
                <mat-option *ngFor="let data of jobTypes" [value]="data">{{data}}
                </mat-option>
            </mat-select>
        </ion-col>
        <ion-col class="display-center" size="3">
            <ion-label class="action-label mar-b-label">Data Set:</ion-label>
            <mat-select placeholder="Select" disableOptionCentering class="form-control drop-mat mat_width_css"
                [(ngModel)]="selectedDataSet">
                <mat-option hidden disabled value="">Select</mat-option>
                <mat-option *ngFor="let dataSetObj of datasetDropdown" [value]="dataSetObj">{{dataSetObj}}
                </mat-option>
            </mat-select>
        </ion-col>
        <ion-col class="display-center" size="2.8">
            <ion-label class="action-label mar-b-label">Jobs:</ion-label>
            <mat-select #mdy panelClass="axis-features" #mdx disableOptionCentering name="jobs" placeholder="Select"
                class="form-control drop-mat mat_width_css x_axis_css" [(ngModel)]="jobs" multiple required>
                <mat-option value="ANOMALYTRAINING1">ANOMALYTRAINING1</mat-option>
                <mat-option value="CORRELATION">CORRELATION</mat-option>
                <ion-row class="border-top">
                    <ion-col>
                        <ion-button type="button" color="light" class="shadowbtn btn-default cancel-mod"
                            (click)="onDropDownClose('Y','clear','');mdy.close()">Clear All
                        </ion-button>
                    </ion-col>
                    <ion-col class="ion-text-end">
                        <ion-button type="button" class="shadowbtn btn-primary run-cor-btn"
                            (click)="onDropDownClose('Y','apply',mdy.value);mdy.close()">Apply</ion-button>
                    </ion-col>
                </ion-row>
            </mat-select>
        </ion-col>
        <ion-col class="display-end" size="3.2">
            <ion-label class="action-label mar-b-label">Model Config:</ion-label>
            <mat-select [disabled]="!enableModelConfig" disableOptionCentering
                class="form-control drop-mat mat_width_css" placeholder="Select" [(ngModel)]="selectedModelConfig">
                <mat-option hidden disabled value="">Select</mat-option>
                <mat-option *ngFor="let data of modelConfigDropdown" [value]="data.modelConfigName">
                    {{data.modelConfigName}}
                </mat-option>
            </mat-select>
        </ion-col>
    </ion-row>
    <ion-row class="header-padding">
        <ion-col size="5.5">
            <ion-label class="action-label mar-b-label"> Pre-Event Date Range </ion-label>
            <ion-row class="date_time">
                <ion-col size="3" class="main-date-div">
                    <input autocomplete="off" matInput class="inputfeild form-control" name="dateFrom"
                        [(ngModel)]="timeFilterVal.fromDate" placeholder="Select Date" (dateChange)="onFromDateChange()"
                        [matDatepicker]="pickerFrom" readonly required />
                    <mat-datepicker-toggle class="dat-pixk" matSuffix [for]="pickerFrom">
                    </mat-datepicker-toggle>
                    <mat-datepicker #pickerFrom></mat-datepicker>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal.fromTimeHr" type="text" name="timeHrFrom" [appAlphaNumeric]="'num'"
                        maxlength="2" required>
                    <p class="time-stamp">
                        (HH)
                    </p>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal.fromTimeMin" type="text" name="timeMinFrom" [appAlphaNumeric]="'num'"
                        maxlength="2" required>
                    <p class="time-stamp">
                        (MM)
                    </p>
                </ion-col>
                <p class="fil-bold">To</p>
                <ion-col size="3" class="main-date-div">
                    <input autocomplete="off" matInput class="inputfeild form-control" name="dateTo" [min]="minToDate"
                        [(ngModel)]="timeFilterVal.toDate" placeholder="Select Date" [matDatepicker]="pickerTo" readonly
                        required />
                    <mat-datepicker-toggle class="dat-pixk" matSuffix [for]="pickerTo">
                    </mat-datepicker-toggle>
                    <mat-datepicker #pickerTo></mat-datepicker>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal.toTimeHr" type="text" name="timeHrTo" [appAlphaNumeric]="'num'"
                        maxlength="2" required>
                    <p class="time-stamp">
                        (HH)
                    </p>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal.toTimeMin" type="text" name="timeMinTo" [appAlphaNumeric]="'num'"
                        maxlength="2" required>
                    <p class="time-stamp">
                        (MM)
                    </p>
                </ion-col>
            </ion-row>
            <!-- <ion-row class="date_time">
        </ion-row> -->
        </ion-col>

        <ion-col size="5.5">
            <ion-label class="action-label mar-b-label">Post-Event Date Range:</ion-label>
            <ion-row class="date_time">
                <ion-col size="3" class="main-date-div">
                    <input autocomplete="off" matInput class="inputfeild form-control" name="dateFrom"
                        [(ngModel)]="timeFilterVal1.fromDate" placeholder="Select Date"
                        (dateChange)="onFromDateChangeAfterUpgrade()" [matDatepicker]="pickerFrom1" readonly required />
                    <mat-datepicker-toggle class="dat-pixk" matSuffix [for]="pickerFrom1">
                    </mat-datepicker-toggle>
                    <mat-datepicker #pickerFrom1></mat-datepicker>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal1.fromTimeHr" type="text" name="timeHrFrom" [appAlphaNumeric]="'num'"
                        maxlength="2" required>
                    <p class="time-stamp">
                        (HH)
                    </p>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal1.fromTimeMin" type="text" name="timeMinFrom"
                        [appAlphaNumeric]="'num'" maxlength="2" required>
                    <p class="time-stamp">
                        (MM)
                    </p>
                </ion-col>
                <p class="fil-bold">To</p>
                <ion-col size="3" class="main-date-div">
                    <input autocomplete="off" matInput class="inputfeild form-control" name="dateTo"
                        [min]="minToDateAfterUpgrade" [(ngModel)]="timeFilterVal1.toDate" placeholder="Select Date"
                        [matDatepicker]="pickerTo1" readonly required />
                    <mat-datepicker-toggle class="dat-pixk" matSuffix [for]="pickerTo1">
                    </mat-datepicker-toggle>
                    <mat-datepicker #pickerTo1></mat-datepicker>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal1.toTimeHr" type="text" name="timeHrTo" [appAlphaNumeric]="'num'"
                        maxlength="2" required>
                    <p class="time-stamp">
                        (HH)
                    </p>
                </ion-col>
                <ion-col size="1" class="input-time-div">
                    <input autocomplete="off" matInput class="input-feild-time form-control" placeholder="00"
                        [(ngModel)]="timeFilterVal1.toTimeMin" type="text" name="timeMinTo" [appAlphaNumeric]="'num'"
                        maxlength="2" required>
                    <p class="time-stamp">
                        (MM)
                    </p>
                </ion-col>
            </ion-row>
            <!-- <ion-row class="date_time"> 
        </ion-row> -->
        </ion-col>
        <ion-col size="1" class="submit-button">
            <ion-button [disabled]="disableSubmitButton" type="button"
                class="btn shadowbtn btn-primary run-cor-btn run-cor-width" (click)="submitData()">
                Submit</ion-button>
        </ion-col>
    </ion-row>
    <ion-row class="status-padding status-row-height" *ngIf="statusWebSocketData">
        <ion-col size="4">
            <ion-label class="action-label data-set mar-b-label" *ngIf="statusWebSocketData">Status:
                {{statusWebSocketData}} <ion-label class="loading" *ngIf="!(statusWebSocketData=== 'ABORTED' || statusWebSocketData=== 'COMPLETED')"></ion-label>
            </ion-label>
        </ion-col>
        <ion-col size="8">
            <ion-radio-group *ngIf="enableAnalysisRadioButton" class="radio-feild-model" [value]='radioButtonValue'
                (ionChange)='switchAnalysisFilter($event)' aria-label="Select an option" name="options">
                <ion-col size="3" class="display-center">
                    <ion-radio value='anomalyAnalysis' name="anomalyAnalysis" class="radio-button">
                    </ion-radio>
                    <ion-label class="option-label">Anomaly Analysis</ion-label>
                </ion-col>
                <ion-col class="radio_css_val display-center">
                    <ion-radio value='correlationAnalysis' class="radio-button" name="correlationAnalysis">
                    </ion-radio>
                    <ion-label class="option-label">Correlation Analysis</ion-label>
                </ion-col>
            </ion-radio-group>
        </ion-col>
    </ion-row>
    <ion-row *ngIf="!statusWebSocketData">
        <ion-col class="ion-text-center ion-padding">
            <ion-label class="action-label data-set mar-b-label">No results available</ion-label>
        </ion-col>
    </ion-row>

    <ion-row *ngIf="featureLoader">
        <ion-col size="12" class="spinner-div">
            <mat-progress-spinner color="slategrey" mode="indeterminate">
            </mat-progress-spinner>
        </ion-col>
    </ion-row>

    <!--Anomaly Analysis-->
    <ion-row *ngIf="enableTable && enableAnomalyAnalysis && anomalyAnalysisPresent" class="table-main">
        <ion-col size="auto" class="body-tab width-fix-left">
            <ion-row class="body-tab-leftRow">
                <ion-col size="12">
                    <ion-label class="action-label mar-b-label">Pre-Event Count:</ion-label>
                    <ion-card>
                        <ion-card-content class="action-label mar-b-label">
                            {{anomalyAnalysis.preEventCount}}
                        </ion-card-content>
                    </ion-card>
                </ion-col>
                <ion-col size="12">
                    <ion-label class="action-label mar-b-label">Post-Event Count:
                    </ion-label>
                    <ion-card>
                        <ion-card-content class="action-label mar-b-label">
                            {{anomalyAnalysis.postEventCount}}
                        </ion-card-content>
                    </ion-card>
                </ion-col>
                <ion-col size="12">
                    <ion-label class="action-label mar-b-label">Total no of Anomalous Count:
                    </ion-label>
                    <ion-card>
                        <ion-card-content class="action-label mar-b-label">
                            {{anomalyAnalysis.anomalousCount}}
                        </ion-card-content>
                    </ion-card>
                </ion-col>
            </ion-row>
        </ion-col>

        <ion-col class="ion-no-padding border-top width-auto-right">
            <ion-row class="ion-no-padding full-hw">
                <ion-row>
                    <ion-col class="page_css_view ion-no-padding">
                        <ion-col class="paginate_css ion-no-padding">
                            <span>
                                <ion-icon class="ion_icon_search" [src]="nwSnapshotService.createSvgUrl('search.svg')">
                                </ion-icon>
                                <input autocomplete="off" maxlength="150" matInput class="form-control css_search"
                                    type="text" [(ngModel)]="searchFilter" placeholder="Search"
                                    (ngModelChange)="onsearchChange(searchFilter)">
                            </span>
                        </ion-col>
                        <ion-col class="dc-flex paginate-align ion-no-padding">
                            <pagination-template #pT="paginationApi" [id]="config.id" class="dc-flex"
                                (pageChange)="changepage($event)">
                                <ion-row class="dc-flex process_rows_css">
                                    <span class="mar-r-8 paginate-text">Rows:</span>
                                    <mat-select disableOptionCentering class="select-page" [(ngModel)]="itemPerPage"
                                        (selectionChange)="setNewPageSize(itemPerPage)">
                                        <mat-option *ngFor="let pgrec of pageArr" [value]="pgrec">{{pgrec}}
                                        </mat-option>
                                    </mat-select>
                                </ion-row>
                                <ion-row class="pagination-previous" [class.disabled]="pT.isFirstPage()">
                                    <button type="button" class="pagination-btn" (click)="pT.previous()"
                                        [disabled]="pT.isFirstPage()">
                                        < </button>
                                </ion-row>

                                <ion-row class="dc-flex process_matselect">
                                    <span class="paginate-text"> Page</span>
                                    <input autocomplete="off" matInput class="currpage-input" type="text"
                                        [(ngModel)]="inputCurrentpage"
                                        (change)="changepageinp(inputCurrentpage,pT.getLastPage())">

                                    <span class="paginate-text"> of {{pT.getLastPage()}}</span>
                                </ion-row>
                                <ion-row class="pagination-next" [class.disabled]="pT.isLastPage()">
                                    <button type="button" class="pagination-btn" (click)="pT.next()"
                                        [disabled]="pT.isLastPage()"> > </button>
                                </ion-row>
                            </pagination-template>
                        </ion-col>
                    </ion-col>
                </ion-row>
                <ion-row class="model-body f-max">

                    <ion-row class="table-wrap">
                        <table>
                            <thead class="sticky-head">
                                <tr>
                                    <th *ngIf="anomalyAnalysisFeatureName.length === 0">
                                        <span class="feature-thead">
                                            {{'Anomaly Details'}}
                                        </span>
                                    </th>
                                    <th *ngFor="let featureObj of anomalyAnalysisFeatureName">
                                        <span class="feature-thead">
                                            <span>
                                                {{featureObj.featureName}}
                                            </span>
                                            <ion-col class="select-cur" (click)="sortAnomaly(featureObj.featureName)">
                                                <ion-icon
                                                    *ngIf="!(anomalyKey == featureObj.featureName && anomalyReverse)"
                                                    aria-hidden="false" class="arrow_mat align-middle mat-top-bottom"
                                                    aria-label="down icon"
                                                    [src]="nwSnapshotService.createSvgUrl('caret-down-sharp.svg')"
                                                    name="caret-down-outline"></ion-icon>
                                                <ion-icon *ngIf="anomalyKey == featureObj.featureName && anomalyReverse"
                                                    aria-hidden="false" class="arrow_mat align-middle mat-top-bottom"
                                                    aria-label="up icon"
                                                    [src]="nwSnapshotService.createSvgUrl('caret-up-sharp.svg')"
                                                    name="caret-up-outline"></ion-icon>
                                            </ion-col>
                                        </span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="body-tr" 
                                    *ngFor="let featureDetObj of anomalyAnalysisFeatureDetails | orderBy: anomalyKey : anomalyReverse | filter :searchFilter | paginate: config">
                                    <td *ngFor="let featureObj of anomalyAnalysisFeatureName" 
                                    [ngClass] = "{'reasonColor':displayReasonColor(featureDetObj,featureObj.fetureKey)}">
                                        {{featureDetObj[featureObj.fetureKey]}}
                                    </td>
                                </tr>
                                <tr class="body-tr"
                                    *ngIf="(anomalyAnalysisFeatureDetails | filter :searchFilter).length === 0">
                                    <td class="no-rec" [attr.colspan]="anomalyAnalysisFeatureName.length">
                                        No records found
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </ion-row>
                </ion-row>
            </ion-row>
        </ion-col>
    </ion-row>
    <ion-row *ngIf="enableAnomalyAnalysis && !anomalyAnalysisPresent">
        <ion-col class="ion-text-center ion-padding">
            <ion-label class="action-label data-set mar-b-label">No results available</ion-label>
        </ion-col>
    </ion-row>

    <!--Correlation Analysis-->
    <ion-row *ngIf="enableTable && enableCorrelationAnalysis && correlationAnalysisPresent" class="table-main">
        <ion-col size="auto" class="body-tab width-fix-left">
            <ion-row class="body-tab-leftRow">
                <ion-col size="12">
                    <ion-label class="action-label mar-b-label">Pre-Event Count:</ion-label>
                    <ion-card>
                        <ion-card-content class="action-label mar-b-label">
                            {{correlationAnalysis.preEventCount}}
                        </ion-card-content>
                    </ion-card>
                </ion-col>
                <ion-col size="12">
                    <ion-label class="action-label mar-b-label">Post-Event Count:
                    </ion-label>
                    <ion-card>
                        <ion-card-content class="action-label mar-b-label">
                            {{correlationAnalysis.postEventCount}}
                        </ion-card-content>
                    </ion-card>
                </ion-col>
            </ion-row>
        </ion-col>

        <ion-col class="ion-no-padding border-top width-auto-right">
            <ion-row class="ion-no-padding full-hw">
                <ion-row>
                    <ion-col class="page_css_view ion-no-padding">
                        <ion-col class="paginate_css ion-no-padding">
                            <span>
                                <ion-icon class="ion_icon_search" [src]="nwSnapshotService.createSvgUrl('search.svg')">
                                </ion-icon>
                                <input autocomplete="off" maxlength="150" matInput class="form-control css_search"
                                    type="text" [(ngModel)]="searchFilter1" placeholder="Search"
                                    (ngModelChange)="onCorrelationSearchChange()">
                            </span>
                        </ion-col>
                        <ion-col class="dc-flex paginate-align ion-no-padding">
                            <pagination-template #pT="paginationApi" [id]="configCorrelation.id" class="dc-flex"
                                (pageChange)="changepageCorrelation($event)">
                                <ion-row class="dc-flex process_rows_css">
                                    <span class="mar-r-8 paginate-text">Rows:</span>
                                    <mat-select disableOptionCentering class="select-page"
                                        [(ngModel)]="itemPerPageCorrelation"
                                        (selectionChange)="setNewPageSizeCorrelation(itemPerPageCorrelation)">
                                        <mat-option *ngFor="let pgrec of pageArrCorrelation" [value]="pgrec">{{pgrec}}
                                        </mat-option>
                                    </mat-select>
                                </ion-row>
                                <ion-row class="pagination-previous" [class.disabled]="pT.isFirstPage()">
                                    <button type="button" class="pagination-btn" (click)="pT.previous()"
                                        [disabled]="pT.isFirstPage()">
                                        < </button>
                                </ion-row>

                                <ion-row class="dc-flex process_matselect">
                                    <span class="paginate-text"> Page</span>
                                    <input autocomplete="off" matInput class="currpage-input" type="text"
                                        [(ngModel)]="inputCurrentpageCorrelation"
                                        (change)="changepageinpCorrelation(inputCurrentpage,pT.getLastPage())">

                                    <span class="paginate-text"> of {{pT.getLastPage()}}</span>
                                </ion-row>
                                <ion-row class="pagination-next" [class.disabled]="pT.isLastPage()">
                                    <button type="button" class="pagination-btn" (click)="pT.next()"
                                        [disabled]="pT.isLastPage()"> > </button>
                                </ion-row>
                            </pagination-template>
                        </ion-col>
                    </ion-col>
                </ion-row>
                <ion-row class="model-body f-max">

                    <ion-row class="table-wrap">
                        <table>
                            <thead class="sticky-head">
                                <tr>
                                    <th *ngIf="correlationAnalysisFeatureName.length === 0">
                                        <span class="feature-thead">
                                            {{'Anomaly Details'}}
                                        </span>
                                    </th>
                                    <th *ngFor="let featureObj of correlationAnalysisFeatureName">
                                        <span class="feature-thead">
                                            <span>
                                                {{featureObj.featureName}}
                                            </span>
                                            <ion-col class="select-cur"
                                                (click)="sortCorrelation(featureObj.featureName)">
                                                <ion-icon
                                                    *ngIf="!(correlationKey == featureObj.featureName && correlationReverse)"
                                                    aria-hidden="false" class="arrow_mat align-middle mat-top-bottom"
                                                    aria-label="down icon"
                                                    [src]="nwSnapshotService.createSvgUrl('caret-down-sharp.svg')"
                                                    name="caret-down-outline"></ion-icon>
                                                <ion-icon
                                                    *ngIf="correlationKey == featureObj.featureName && correlationReverse"
                                                    aria-hidden="false" class="arrow_mat align-middle mat-top-bottom"
                                                    aria-label="up icon"
                                                    [src]="nwSnapshotService.createSvgUrl('caret-up-sharp.svg')"
                                                    name="caret-up-outline"></ion-icon>
                                            </ion-col>
                                        </span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="body-tr"
                                    *ngFor="let featureDetObj of correlationAnalysisFeatureDetails | orderBy: correlationKey : correlationReverse | filter :searchFilter1 | paginate: configCorrelation">
                                    <td *ngFor="let featureObj of correlationAnalysisFeatureName">
                                        {{featureDetObj[featureObj.fetureKey]}}
                                    </td>
                                </tr>
                                <tr class="body-tr"
                                    *ngIf="(correlationAnalysisFeatureDetails | filter :searchFilter1).length === 0">
                                    <td class="no-rec" [attr.colspan]="correlationAnalysisFeatureName.length">
                                        No records found
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </ion-row>
                </ion-row>
            </ion-row>
        </ion-col>
    </ion-row>
    <ion-row *ngIf="enableCorrelationAnalysis && !correlationAnalysisPresent">
        <ion-col class="ion-text-center ion-padding">
            <ion-label class="action-label data-set mar-b-label">No results available</ion-label>
        </ion-col>
    </ion-row>
</ion-row>